<!-- Form starts -->

<form [formGroup]="itemsForm" (ngSubmit)="onSubmit()">


  <div formArrayName="items" class="container">
    <mat-card *ngFor="let item of items.controls; let i=index" class="row mb-3">
      <div [formGroupName]="i" class="col">
        <input type="hidden" formControlName="id" />
        <div class="conatiner">
          <div class="row">
            <div class="col-sm-3 min-width-img">
              <img src="../assets/img{{item.value.img}}" class="img" />
            </div>
            <div class="col">
              <div class="container">
                <div class="row">
                  <div class="col">
                    <h4>
                      {{item.value.name}}
                    </h4>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-9">
                    <mat-form-field appearance="fill">
                      <mat-label>Cantidad</mat-label>
                      <input matInput formControlName="quantity" type="number" min="1" max="{{item.value.stock}}" (change)="handleQuantityPersistence(item)">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <h5>Precio: {{calcSingleItemPrice(item.value.quantity, item.value.price)}}€</h5>
                  </div>
                </div>
              </div>
            </div>

            <button (click)="removeItem(i)">Remove</button>
          </div>
        </div><!--end row-->
      </div><!--end conteiner within-->
    </mat-card>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <h3>
          Total: {{totalPrice}}€
        </h3>
      </div>
    </div>
    <div class="row" *ngIf="errorReport.isError">
      <div class="col">
        <div class="alert alert-danger" role="alert">
          <strong>Uno o varios productos no tienen suficiente stock para llevar a cavo esta orden</strong>: {{errorReport.text}}
        </div>
      </div>
      </div>
        <div class="row">
          <div class="col">
            <button type="submit">Submit</button>
          </div>
        </div>
      </div>

</form>


<!--<p>
  <button type="button" (click)="addSkills()">Add</button>
</p>-->





<!-- Form ends -->
<!--
<mat-form-field appearance="fill">
        <mat-label>Cantidad</mat-label>
        <input matInput type="number" value="{{product.quantity}}" min="1" max="{{product.stock}}">
      </mat-form-field>

-->
